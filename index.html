<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Status | BakedIn</title>
    <meta name="description" content="Real-time system status for BakedIn services">
    <link rel="icon" href="https://bakedin.co/favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #947619;
            --gold-light: #b8942e;
            --gold-glow: rgba(148, 118, 25, 0.4);
            --bg-dark: #0d0c0a;
            --bg-card: #1a1815;
            --bg-card-hover: #252219;
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.6);
            --text-muted: rgba(255, 255, 255, 0.4);
            --success: #22c55e;
            --success-glow: rgba(34, 197, 94, 0.3);
            --warning: #f59e0b;
            --warning-glow: rgba(245, 158, 11, 0.3);
            --error: #ef4444;
            --error-glow: rgba(239, 68, 68, 0.3);
            --border: rgba(148, 118, 25, 0.2);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
        }
        .bg-pattern {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
            opacity: 0.025;
            background-image:
                linear-gradient(rgba(148, 118, 25, 0.5) 1px, transparent 1px),
                linear-gradient(90deg, rgba(148, 118, 25, 0.5) 1px, transparent 1px);
            background-size: 80px 80px;
        }
        .bg-glow {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
            background:
                radial-gradient(ellipse 80% 50% at 50% 0%, rgba(148, 118, 25, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse 60% 40% at 80% 80%, rgba(148, 118, 25, 0.08) 0%, transparent 40%);
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 60px 24px;
            position: relative;
            z-index: 10;
        }
        header {
            text-align: center;
            margin-bottom: 48px;
        }
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 24px;
            text-decoration: none;
        }
        .logo img {
            height: 48px;
            filter: drop-shadow(0 0 20px var(--gold-glow));
        }
        .logo-text {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.75rem;
            font-weight: 500;
            color: var(--text-primary);
        }
        .logo-text span { color: var(--gold); }
        h1 {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 2rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        header p {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        .status-banner {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            padding: 20px 32px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-bottom: 32px;
            transition: all 0.3s ease;
        }
        .status-banner.operational {
            border-color: rgba(34, 197, 94, 0.3);
            box-shadow: 0 0 40px rgba(34, 197, 94, 0.1);
        }
        .status-banner.degraded {
            border-color: rgba(245, 158, 11, 0.3);
            box-shadow: 0 0 40px rgba(245, 158, 11, 0.1);
        }
        .status-banner.outage {
            border-color: rgba(239, 68, 68, 0.3);
            box-shadow: 0 0 40px rgba(239, 68, 68, 0.1);
        }
        .status-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            position: relative;
        }
        .status-dot::before {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }
        .status-dot.operational { background: var(--success); box-shadow: 0 0 12px var(--success-glow); }
        .status-dot.operational::before { background: var(--success); opacity: 0.3; }
        .status-dot.degraded { background: var(--warning); box-shadow: 0 0 12px var(--warning-glow); }
        .status-dot.degraded::before { background: var(--warning); opacity: 0.3; }
        .status-dot.outage { background: var(--error); box-shadow: 0 0 12px var(--error-glow); }
        .status-dot.outage::before { background: var(--error); opacity: 0.3; }
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.5); opacity: 0; }
        }
        .status-text {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 1.25rem;
            font-weight: 500;
        }
        .status-text.operational { color: var(--success); }
        .status-text.degraded { color: var(--warning); }
        .status-text.outage { color: var(--error); }
        .services-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 24px;
        }
        .services-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
        }
        .services-header h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-secondary);
        }
        .services-header .icon {
            font-size: 1.2rem;
            margin-right: 10px;
        }
        .uptime-label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        .service-list { list-style: none; }
        .service-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 24px;
            border-bottom: 1px solid var(--border);
            transition: background 0.2s ease;
        }
        .service-item:last-child { border-bottom: none; }
        .service-item:hover { background: var(--bg-card-hover); }
        .service-info {
            display: flex;
            align-items: center;
            gap: 14px;
            flex: 1;
        }
        .service-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        .service-dot.up { background: var(--success); box-shadow: 0 0 8px var(--success-glow); }
        .service-dot.degraded { background: var(--warning); box-shadow: 0 0 8px var(--warning-glow); }
        .service-dot.down { background: var(--error); box-shadow: 0 0 8px var(--error-glow); }
        .service-details { flex: 1; }
        .service-name {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 2px;
        }
        .service-desc {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        .service-meta {
            display: flex;
            align-items: center;
            gap: 24px;
        }
        .service-uptime {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-variant-numeric: tabular-nums;
        }
        .service-response {
            font-size: 0.8rem;
            color: var(--text-muted);
            min-width: 70px;
            text-align: right;
        }
        .infra-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }
        .infra-card h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }
        .infra-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }
        .infra-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--bg-dark);
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        .infra-icon {
            font-size: 1.5rem;
            opacity: 0.8;
        }
        .infra-details h4 {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 2px;
        }
        .infra-details p {
            font-size: 0.75rem;
            color: var(--text-muted);
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }
        @media (max-width: 700px) {
            .metrics-grid { grid-template-columns: repeat(2, 1fr); }
            .service-meta { gap: 16px; }
            .service-response { display: none; }
            .service-desc { display: none; }
        }
        .metric-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }
        .metric-card:hover {
            border-color: var(--gold);
            box-shadow: 0 0 30px rgba(148, 118, 25, 0.1);
        }
        .metric-value {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 1.75rem;
            font-weight: 500;
            color: var(--gold);
            margin-bottom: 4px;
        }
        .metric-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        footer {
            text-align: center;
            padding-top: 24px;
            border-top: 1px solid var(--border);
        }
        footer p {
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        footer a {
            color: var(--gold);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        footer a:hover { color: var(--gold-light); }
        .last-updated {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 12px;
        }
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px;
            color: var(--text-muted);
        }
        .loading::after {
            content: '';
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
            border-top-color: var(--gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 12px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    <div class="bg-glow"></div>
    <div class="container">
        <header>
            <a class="logo" href="https://bakedin.co">
                <img src="https://bakedin.co/bakedin_gold_logo.png" alt="BakedIn">
                <span class="logo-text">Baked<span>In</span></span>
            </a>
            <h1>System Status</h1>
            <p>Real-time monitoring of BakedIn infrastructure</p>
        </header>

        <div class="status-banner operational" id="overall-status">
            <div class="status-dot operational"></div>
            <span class="status-text operational">All Systems Operational</span>
        </div>

        <!-- Customer-Facing Services -->
        <div class="services-card">
            <div class="services-header">
                <h2><span class="icon">üåê</span>Customer-Facing Services</h2>
                <span class="uptime-label">30-day uptime</span>
            </div>
            <ul class="service-list" id="customer-services"></ul>
        </div>

        <!-- AI Infrastructure -->
        <div class="services-card">
            <div class="services-header">
                <h2><span class="icon">ü§ñ</span>AI Infrastructure</h2>
                <span class="uptime-label">30-day uptime</span>
            </div>
            <ul class="service-list" id="ai-services"></ul>
        </div>

        <!-- Internal Infrastructure -->
        <div class="infra-card">
            <h3>üîí Internal Infrastructure (CloudWatch Monitored)</h3>
            <div class="infra-grid">
                <div class="infra-item">
                    <span class="infra-icon">‚ö°</span>
                    <div class="infra-details">
                        <h4>GPU Inference</h4>
                        <p>NVIDIA L4 (g6.xlarge)</p>
                    </div>
                </div>
                <div class="infra-item">
                    <span class="infra-icon">üóÑÔ∏è</span>
                    <div class="infra-details">
                        <h4>PostgreSQL</h4>
                        <p>RDS db.t4g.micro</p>
                    </div>
                </div>
                <div class="infra-item">
                    <span class="infra-icon">üï∏Ô∏è</span>
                    <div class="infra-details">
                        <h4>Neptune Graph</h4>
                        <p>Serverless Knowledge Graph</p>
                    </div>
                </div>
                <div class="infra-item">
                    <span class="infra-icon">üîê</span>
                    <div class="infra-details">
                        <h4>Security MCP</h4>
                        <p>OWASP Scanning</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-value" id="avg-uptime">--</div>
                <div class="metric-label">Avg Uptime</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="services-up">--</div>
                <div class="metric-label">Services Up</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="response-time">--</div>
                <div class="metric-label">Avg Response</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="incidents">0</div>
                <div class="metric-label">Incidents</div>
            </div>
        </div>

        <footer>
            <p>Monitored by <a href="https://upptime.js.org" target="_blank" rel="noopener">Upptime</a> + <a href="https://aws.amazon.com/cloudwatch/" target="_blank" rel="noopener">CloudWatch</a></p>
            <p class="last-updated" id="last-updated">Last updated: --</p>
        </footer>
    </div>

    <script>
        const serviceDescriptions = {
            'Marketing Website': 'Public website at bakedin.co',
            'Staging Environment': 'Pre-production testing environment',
            'MCP Gateway': 'Model Context Protocol API gateway',
            'Research MCP': 'OpenAlex, ArXiv, Papers with Code',
            'Knowledge Graph MCP': 'Neptune graph database queries',
            'CI/CD MCP': 'Pipeline control and deployments',
            'Dashboard MCP': 'Metrics and visualization',
            'Context MCP': 'Session context management',
            'Assets MCP': 'Asset registry and tracking',
            'AI Investigator MCP': 'AI research monitoring'
        };

        const customerServices = ['Marketing Website', 'Staging Environment'];
        const aiServices = ['MCP Gateway', 'Research MCP', 'Knowledge Graph MCP', 'CI/CD MCP', 'Dashboard MCP', 'Context MCP', 'Assets MCP', 'AI Investigator MCP'];

        function renderService(service) {
            const isUp = service.status === 'up';
            const statusClass = isUp ? 'up' : (service.status === 'degraded' ? 'degraded' : 'down');
            const uptime = parseFloat(service.uptimeMonth) || 0;
            const responseTime = service.timeMonth ? Math.round(service.timeMonth) + 'ms' : '--';
            const desc = serviceDescriptions[service.name] || '';

            return '<li class="service-item">' +
                '<div class="service-info">' +
                '<div class="service-dot ' + statusClass + '"></div>' +
                '<div class="service-details">' +
                '<div class="service-name">' + service.name + '</div>' +
                '<div class="service-desc">' + desc + '</div>' +
                '</div></div>' +
                '<div class="service-meta">' +
                '<span class="service-uptime">' + uptime.toFixed(2) + '%</span>' +
                '<span class="service-response">' + responseTime + '</span>' +
                '</div></li>';
        }

        async function loadStatus() {
            try {
                const response = await fetch('history/summary.json');
                const services = await response.json();

                let customerHtml = '';
                let aiHtml = '';
                let upCount = 0;
                let totalUptime = 0;
                let totalResponse = 0;
                let validUptimeCount = 0;
                let validResponseCount = 0;

                services.forEach(function(service) {
                    if (service.status === 'up') upCount++;

                    const uptime = parseFloat(service.uptimeMonth) || 0;
                    if (uptime > 0) {
                        totalUptime += uptime;
                        validUptimeCount++;
                    }

                    const responseTime = parseFloat(service.timeMonth) || 0;
                    if (responseTime > 0) {
                        totalResponse += responseTime;
                        validResponseCount++;
                    }

                    if (customerServices.includes(service.name)) {
                        customerHtml += renderService(service);
                    } else if (aiServices.includes(service.name)) {
                        aiHtml += renderService(service);
                    }
                });

                document.getElementById('customer-services').innerHTML = customerHtml || '<li class="loading">No customer services configured</li>';
                document.getElementById('ai-services').innerHTML = aiHtml || '<li class="loading">No AI services configured</li>';

                const avgUptime = validUptimeCount > 0 ? (totalUptime / validUptimeCount).toFixed(1) : '100';
                const avgResponse = validResponseCount > 0 ? Math.round(totalResponse / validResponseCount) : '--';

                document.getElementById('avg-uptime').textContent = avgUptime + '%';
                document.getElementById('services-up').textContent = upCount + '/' + services.length;
                document.getElementById('response-time').textContent = avgResponse + 'ms';

                const overallBanner = document.getElementById('overall-status');
                const allUp = upCount === services.length;
                const anyDown = services.some(function(s) { return s.status === 'down'; });

                if (allUp) {
                    overallBanner.className = 'status-banner operational';
                    overallBanner.innerHTML = '<div class="status-dot operational"></div><span class="status-text operational">All Systems Operational</span>';
                } else if (anyDown) {
                    overallBanner.className = 'status-banner outage';
                    overallBanner.innerHTML = '<div class="status-dot outage"></div><span class="status-text outage">Service Disruption</span>';
                } else {
                    overallBanner.className = 'status-banner degraded';
                    overallBanner.innerHTML = '<div class="status-dot degraded"></div><span class="status-text degraded">Partial Outage</span>';
                }

                document.getElementById('last-updated').textContent = 'Last updated: ' + new Date().toLocaleString();

            } catch (error) {
                console.error('Failed to load status:', error);
                document.getElementById('customer-services').innerHTML = '<li class="service-item"><div class="service-info"><div class="service-dot down"></div><span class="service-name">Unable to load status</span></div></li>';
                document.getElementById('ai-services').innerHTML = '<li class="service-item"><div class="service-info"><div class="service-dot down"></div><span class="service-name">Unable to load status</span></div></li>';
            }
        }

        loadStatus();
        setInterval(loadStatus, 60000);
    </script>
</body>
</html>
